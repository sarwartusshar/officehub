!function(){"use strict";angular.module("OfficeHub",["AdalAngular","ngSanitize","ui.router","angularMoment","infinite-scroll","ngWig"])}(),function(){angular.module("OfficeHub").service("MessagesService",["$http","$q",function(s,e){this.getMessages=function(a,n){var t=e.defer(),o="https://graph.microsoft.com/beta/me/MailFolders/Inbox/messages?&top="+a;return n>1&&(o+="&$skip="+(n-1)*a),s.get(o).success(function(s,e,a,n){t.resolve(s)}).error(function(s,e,a,n){t.reject()}),t.promise},this.getMessage=function(a){var n=e.defer(),t="https://graph.microsoft.com/beta/me/messages/"+a;return s.get(t).success(function(s,e,a,t){n.resolve(s)}).error(function(s,e,a,t){n.reject()}),n.promise},this.updateMessage=function(a,n){var t=e.defer(),o="https://graph.microsoft.com/beta/me/messages/"+a;return s.patch(o,n).success(function(s,e,a,n){t.resolve(s)}).error(function(s,e,a,n){t.reject()}),t.promise},this.deleteMessage=function(a){var n=e.defer(),t="https://graph.microsoft.com/beta/me/messages/"+a;return s["delete"](t).success(function(s,e,a,t){n.resolve(s)}).error(function(s,e,a,t){n.reject()}),n.promise},this.sendMessage=function(a,n,t,o){var i=e.defer(),m="https://graph.microsoft.com/beta/me/sendmail",r={Message:{Subject:n,Body:{ContentType:"HTML",Content:t},ToRecipients:[]},SaveToSentItems:o};return angular.forEach(a,function(s){r.Message.ToRecipients.push({EmailAddress:{Address:s.trim()}})}),s.post(m,r).success(function(s,e,a,n){i.resolve(s)}).error(function(s,e,a,n){i.reject()}),i.promise},this.createReply=function(a){var n=e.defer(),t="https://graph.microsoft.com/beta/me/messages/"+a+"/CreateReply";return s.post(t).success(function(s,e,a,t){n.resolve(s)}).error(function(s,e,a,t){n.reject()}),n.promise}}])}(),function(){angular.module("OfficeHub").controller("ReplyController",["$state","$stateParams","MessagesService",function(s,e,a){var n=this,t=null;n.Message=null,n.ToAddresses="",n.CcAddresses="",n.Subject="",n.Body="",n.sendMessage=function(){a.sendMessage(n.ToAddresses.split(";"),n.Subject,n.Body,!0).then(function(e){s.go("root.messages")},function(){})},n.cancel=function(){n.Message?s.go("root.message",{id:n.Message.Id}):s.go("root.messages")};var o=function(){t=e.id,i().then(function(){m()})},i=function(){return a.getMessage(t).then(function(s){n.Message=s,n.Message.IsRead||n.toggleReadStatus()},function(){n.Messages=null})},m=function(){return a.createReply(t).then(function(s){n.ToAddresses=n.Message.Sender.EmailAddress.Address,n.Subject=s.Subject,n.Body="<br /><br />"+s.Body.Content},function(){})};o()}])}(),function(){angular.module("OfficeHub").controller("NewMessageController",["$state","MessagesService",function(s,e){var a=this;a.ToAddresses="",a.CcAddresses="",a.Subject="",a.Body="",a.sendMessage=function(){e.sendMessage(a.ToAddresses.split(";"),a.Subject,a.Body,!0).then(function(e){s.go("root.messages")},function(){})},a.cancel=function(){s.go("root.messages")}}])}(),function(){angular.module("OfficeHub").controller("MessageController",["$state","$stateParams","MessagesService",function(s,e,a){var n=this,t=null;n.Message=null,n.loadMessage=function(){a.getMessage(t).then(function(s){n.Message=s,n.Message.IsRead||n.toggleReadStatus()},function(){n.Messages=null})},n.toggleReadStatus=function(){var s={IsRead:!n.Message.IsRead};a.updateMessage(t,s).then(function(s){n.Message=s},function(){})},n.deleteMessage=function(){a.deleteMessage(t).then(function(){s.go("root.messages")},function(){})},n.goToReply=function(){s.go("root.messageReply",{id:n.Message.Id})},n.goToMessages=function(){s.go("root.messages")};var o=function(){t=e.id,n.loadMessage()};o()}])}(),function(){angular.module("OfficeHub").controller("InboxController",["$scope","$state","MessagesService",function(s,e,a){var n=this,t=10,o=!1,i=1;n.Messages=[],n.HasNextPage=!0,n.getNextMessages=function(){if(i*t!=this.Messages.length){if(o)return;o=!0,a.getMessages(t,i).then(function(s){i+=1,angular.forEach(s.value,function(s){n.Messages.push(s)}),o=!1},function(){console.log("An error occured")})}},n.toggleReadStatus=function(s){var e={IsRead:!n.Messages[s].IsRead};a.updateMessage(n.Messages[s].Id,e).then(function(e){n.Messages[s].IsRead=e.IsRead},function(){})},n.toggleFlag=function(s){var e={IsFlagged:!n.Messages[s].IsRead};a.updateMessage(n.Messages[s].Id,e).then(function(e){n.Messages[s].IsRead=e.IsRead},function(){})},n.reload=function(){n.Messages=[],o=!1,i=1,n.getNextMessages()},n.goToMessage=function(s){e.go("root.message",{id:s.Id})},n.goToNewEmail=function(){e.go("root.messageNew")},n.deleteMessage=function(s){a.deleteMessage(s.Id).then(function(){var a=n.Messages.indexOf(s);n.Messages.splice(a,1),e.go("root.messages")},function(){})};var m=function(){};m()}])}(),function(){angular.module("OfficeHub").service("UsersService",["$http","$q",function(s,e){this.getUserPhoto=function(a){var n=e.defer(),t="https://graph.microsoft.com/beta/me/Photos/"+a+"/$value";return s.get(t,{responseType:"blob"}).success(function(s,e,a,t){var o=window.URL||window.webkitURL,i=o.createObjectURL(s);n.resolve(i)}).error(function(s,e,a,t){n.reject()}),n.promise}}])}(),function(){angular.module("OfficeHub").controller("AdalController",["adalAuthenticationService","UsersService",function(s,e){var a=this;a.userPhoto="",a.login=function(){s.login()},a.logout=function(){s.logOut()};var n=function(){a.userPhoto=t()},t=function(){e.getUserPhoto("96X96").then(function(s){a.userPhoto=s},function(){})};n()}])}(),
// Copyright (c) Microsoft. All rights reserved. Licensed under the MIT license. See LICENSE in the project root for license information.
function(s){s.fn.NavBar=function(){return this.each(function(){var e=s(this);e.on("click",".js-openMenu",function(s){s.stopPropagation(),e.toggleClass("is-open")}),e.click(function(){e.hasClass("is-open")&&e.removeClass("is-open")}),e.on("click",".ms-NavBar-item:not(.is-disabled)",function(a){a.stopPropagation(),0===s(this).children(".ms-NavBar-link").length&&a.preventDefault(),s(this).siblings(".ms-NavBar-item").removeClass("is-selected"),0===e.find(".ms-NavBar-item.ms-NavBar-item--search .ms-TextField-field").val().length&&s(".ms-NavBar-item.ms-NavBar-item--search").removeClass("is-open").find(".ms-TextField-field").blur(),s(this).hasClass("ms-NavBar-item--hasMenu")?(s(this).children(".ms-ContextualMenu:first").toggleClass("is-open"),s(this).toggleClass("is-selected")):(s(this).addClass("is-selected"),e.removeClass("is-open").find(".ms-ContextualMenu").removeClass("is-open")),s(this).hasClass("ms-NavBar-item--search")&&(s(this).addClass("is-open"),s(this).find(".ms-TextField-field").focus(),e.find(".ms-ContextualMenu:first").removeClass("is-open"))}),e.on("click",".ms-NavBar-item .ms-ContextualMenu",function(a){a.stopPropagation(),s(this).removeClass("is-open"),e.removeClass("is-open").find(".ms-NavBar-item--hasMenu").removeClass("is-selected")}),s(document).on("click","html",function(s){e.find(".ms-NavBar-item").removeClass("is-selected").find(".ms-ContextualMenu").removeClass("is-open"),0===e.find(".ms-NavBar-item.ms-NavBar-item--search .ms-TextField-field").val().length&&e.find(".ms-NavBar-item.ms-NavBar-item--search").removeClass("is-open").find(".ms-TextField-field").blur()})})}}(jQuery),function(){"use strict";function s(s,e,a){e.$state=a,s.debug("runBlock end")}angular.module("OfficeHub").run(s),s.$inject=["$log","$rootScope","$state"]}(),function(){"use strict";function s(s,e,a){s.state("root",{url:"","abstract":!0,views:{header:{templateUrl:"app/components/header/header.html"},footer:{templateUrl:"app/components/footer/footer.html"},navigation:{templateUrl:"app/components/navigation/navigation.html"}}}).state("root.home",{url:"/",views:{"container@":{templateUrl:"app/components/home/home.html"}}}).state("root.messages",{url:"/messages",views:{"container@":{templateUrl:"app/components/messages/views/inbox.html",controller:"InboxController",controllerAs:"vm"}},requireADLogin:!0}).state("root.messageNew",{url:"/messages/compose",views:{"container@":{templateUrl:"app/components/messages/views/compose.html",controller:"NewMessageController",controllerAs:"vm"}},requireADLogin:!0}).state("root.message",{url:"/messages/:id",views:{"container@":{templateUrl:"app/components/messages/views/message.html",controller:"MessageController",controllerAs:"vm"}},requireADLogin:!0}).state("root.messageReply",{url:"/messages/compose/:id",views:{"container@":{templateUrl:"app/components/messages/views/compose.html",controller:"ReplyController",controllerAs:"vm"}},requireADLogin:!0}),e.otherwise("/")}angular.module("OfficeHub").config(s),s.$inject=["$stateProvider","$urlRouterProvider","$locationProvider"]}(),function(){"use strict";angular.module("OfficeHub").constant("moment",moment)}(),function(){"use strict";function s(s,e,a){a.init({clientId:"8678d1cb-82dc-4520-a750-71d1e4f38f57",postLogoutRedirectUri:"http://localhost:3000",endpoints:{"https://graph.microsoft.com":"https://graph.microsoft.com"}},e),s.debugEnabled(!0)}angular.module("OfficeHub").config(s),s.$inject=["$logProvider","$httpProvider","adalAuthenticationServiceProvider"]}(),angular.module("OfficeHub").run(["$templateCache",function(s){s.put("app/main/main.html",'<div class="ms-Grid"><div ui-view="" name="navigation"></div><div ui-view="" name="header"></div><div class="ms-Grid-row"><div ui-view="" name="content"></div><div ui-view="" name="footer"></div></div></div>'),s.put("app/components/footer/footer.html",'<footer id="page-footer" class="ms-Grid-row ms-Grid-col ms-u-sm12 ms-font-m ms-fontWeight-light ms-fontColor-white"><p>Microsoft, Office, Office 365 and SharePoint are registered trademarks of Microsoft Corporation.</p><p>Current Version of the Office UI Fabric used on this site: v1.0.0</p></footer>'),s.put("app/components/header/header.html",""),s.put("app/components/home/home.html",'<article id="page-main" class="ms-Grid-col ms-u-sm12 ms-font-m"><p class="ms-font-su">Components</p><p class="ms-font-l">View all the components available in the Office UI Fabric. While the site is in progress the icons in the navigation to indicate if the work is <i class="ms-Icon ms-Icon--checkboxEmpty"></i> pending or <i class="ms-Icon ms-Icon--tasks"></i> completed. Items not yet complete will point to the corresponding issue in the GitHub list.</p></article>'),s.put("app/components/navigation/navigation.html",'<div id="page-navigation" class="ms-NavBar" ng-controller="AdalController as adal"><ul class="ms-NavBar-items"><li class="ms-NavBar-item"><a class="ms-NavBar-link" ui-sref="root.home">Home</a></li><li class="ms-NavBar-item"><a class="ms-NavBar-link" ui-sref="root.messages">Messages</a></li><li class="ms-NavBar-item ms-NavBar-item--right" ng-if="!userInfo.isAuthenticated"><a class="ms-NavBar-link" ng-click="adal.login()">Login</a></li><li class="ms-NavBar-item ms-NavBar-item--right" ng-if="userInfo.isAuthenticated"><a class="ms-NavBar-link" ng-click="adal.logout()">Logout</a></li><li class="ms-NavBar-item is-disabled ms-NavBar-item--right" ng-if="userInfo.isAuthenticated"><div class="ms-Persona ms-Persona--xs"><div class="ms-Persona-imageArea"><div class="ms-Persona-imageCircle"><i class="ms-Persona-placeholder ms-Icon ms-Icon--person"></i> <img class="ms-Persona-image" ng-src="{{ adal.userPhoto }}"></div></div><div class="ms-Persona-details"><a class="ms-NavBar-link">{{ userInfo.profile.name }}</a></div></div></li></ul></div>'),s.put("app/components/messages/views/compose.html",'<article id="page-main" class="ms-Grid-col ms-u-sm12 ms-font-m"><div class="ms-CommandBar mail-bar"><div class="ms-CommandBar-sideCommands"><div class="ms-CommandBarItem ms-CommandBarItem--iconOnly" ng-click="vm.cancel()"><div class="ms-CommandBarItem-linkWrapper"><div class="ms-CommandBarItem-link"><span class="ms-CommandBarItem-icon ms-Icon ms-Icon--x"></span></div></div></div></div><div class="ms-CommandBar-mainArea"><div class="ms-CommandBarItem" ng-click="vm.sendMessage()"><div class="ms-CommandBarItem-linkWrapper"><div class="ms-CommandBarItem-link"><span class="ms-CommandBarItem-icon ms-Icon ms-Icon--mailSend"></span> <span class="ms-CommandBarItem-commandText ms-font-m ms-font-weight-regular">Send</span></div></div></div></div><div class="ms-CommandBarItem ms-CommandBarItem--iconOnly ms-CommandBarItem-overflow"><div class="ms-CommandBarItem-linkWrapper"><div class="ms-CommandBarItem-link"><span class="ms-CommandBarItem-icon ms-Icon ms-Icon--ellipsis"></span> <span class="ms-CommandBarItem-commandText ms-font-m ms-font-weight-regular"></span> <i class="ms-CommandBarItem-chevronDown ms-Icon ms-Icon--chevronDown"></i></div></div><ul class="ms-CommandBar-overflowMenu ms-ContextualMenu"></ul></div></div><p class="ms-font-xxl page-title">{{ vm.Subject }}</p><div class="ms-TextField ms-TextField--underlined"><label class="ms-Label">To:</label> <input class="ms-TextField-field" ng-model="vm.ToAddresses"></div><div class="ms-TextField ms-TextField--underlined"><label class="ms-Label">Cc:</label> <input class="ms-TextField-field" ng-model="vm.CcAddresses"></div><div class="ms-TextField ms-TextField--underlined"><label class="ms-Label">Subject:</label> <input class="ms-TextField-field" ng-model="vm.Subject"></div><div ng-wig="vm.Body"></div></article>'),s.put("app/components/messages/views/inbox.html",'<article id="page-main" class="ms-Grid-col ms-u-sm12 ms-font-m"><div class="top-info"><div class="ms-CommandBar mail-bar"><div class="ms-CommandBar-sideCommands"><div class="ms-CommandBarItem ms-CommandBarItem--iconOnly" ng-click="vm.reload()"><div class="ms-CommandBarItem-linkWrapper"><div class="ms-CommandBarItem-link"><span class="ms-CommandBarItem-icon ms-Icon ms-Icon--reload"></span></div></div></div></div><div class="ms-CommandBar-mainArea"><div class="ms-CommandBarItem" ng-click="vm.goToNewEmail()"><div class="ms-CommandBarItem-linkWrapper"><div class="ms-CommandBarItem-link"><span class="ms-CommandBarItem-icon ms-Icon ms-Icon--circlePlus"></span> <span class="ms-CommandBarItem-commandText ms-font-m ms-font-weight-regular">New</span></div></div></div><div class="ms-CommandBarItem ms-CommandBarItem--iconOnly ms-CommandBarItem-overflow"><div class="ms-CommandBarItem-linkWrapper"><div class="ms-CommandBarItem-link"><span class="ms-CommandBarItem-icon ms-Icon ms-Icon--ellipsis"></span> <span class="ms-CommandBarItem-commandText ms-font-m ms-font-weight-regular"></span> <i class="ms-CommandBarItem-chevronDown ms-Icon ms-Icon--chevronDown"></i></div></div><ul class="ms-CommandBar-overflowMenu ms-ContextualMenu"></ul></div></div></div><p class="ms-font-xxl page-title">Messages</p></div><ul class="ms-List mail-list" infinite-scroll="vm.getNextMessages()"><div class="ms-ListItem is-selectable mail-item" ng-class="{true: \'\', false: \'is-unread\'}[message.IsRead]" data-ng-repeat="message in vm.Messages"><span class="ms-ListItem-primaryText" ng-click="vm.goToMessage(message)">{{ message.Sender.EmailAddress.Name }}</span> <span class="ms-ListItem-secondaryText" ng-click="vm.goToMessage(message)">{{ message.Subject }}</span> <span class="ms-ListItem-tertiaryText">{{ message.BodyPreview }}</span> <span class="ms-ListItem-metaText">{{ message.ReceivedDateTime | amCalendar }}</span><div class="ms-ListItem-selectionTarget js-toggleSelection"></div><div class="ms-ListItem-actions"><div class="ms-ListItem-action" ng-click="vm.deleteMessage(message)"><i class="ms-Icon ms-Icon--trash"></i></div><div class="ms-ListItem-action" ng-click="vm.toggleReadStatus($index)"><i class="ms-Icon ms-Icon--mailUnread"></i></div></div></div></ul></article>'),s.put("app/components/messages/views/message.html",'<article id="page-main" class="ms-Grid-col ms-u-sm12 ms-font-m"><div class="ms-CommandBar mail-bar"><div class="ms-CommandBar-sideCommands"><div class="ms-CommandBarItem ms-CommandBarItem--iconOnly" ng-click="vm.goToMessages()"><div class="ms-CommandBarItem-linkWrapper"><div class="ms-CommandBarItem-link"><span class="ms-CommandBarItem-icon ms-Icon ms-Icon--x"></span></div></div></div></div><div class="ms-CommandBar-mainArea"><div class="ms-CommandBarItem" ng-click="vm.goToReply()"><div class="ms-CommandBarItem-linkWrapper"><div class="ms-CommandBarItem-link"><span class="ms-CommandBarItem-icon ms-Icon ms-Icon--reply"></span> <span class="ms-CommandBarItem-commandText ms-font-m ms-font-weight-regular">Reply</span></div></div></div><div class="ms-CommandBarItem" ng-click="vm.deleteMessage()"><div class="ms-CommandBarItem-linkWrapper"><div class="ms-CommandBarItem-link"><span class="ms-CommandBarItem-icon ms-Icon ms-Icon--trash"></span> <span class="ms-CommandBarItem-commandText ms-font-m ms-font-weight-regular">Delete</span></div></div></div><div class="ms-CommandBarItem ms-CommandBarItem--iconOnly ms-CommandBarItem-overflow"><div class="ms-CommandBarItem-linkWrapper"><div class="ms-CommandBarItem-link"><span class="ms-CommandBarItem-icon ms-Icon ms-Icon--ellipsis"></span> <span class="ms-CommandBarItem-commandText ms-font-m ms-font-weight-regular"></span> <i class="ms-CommandBarItem-chevronDown ms-Icon ms-Icon--chevronDown"></i></div></div><ul class="ms-CommandBar-overflowMenu ms-ContextualMenu"></ul></div></div></div><p class="ms-font-xxl page-title">{{ vm.Message.Subject }}</p><p ng-cloak="">From: <span class="ms-fontWeight-semibold">{{ vm.Message.Sender.EmailAddress.Name }} ({{ vm.Message.Sender.EmailAddress.Address }})</span></p><div data-ng-bind-html="vm.Message.Body.Content"></div></article>')}]);
//# sourceMappingURL=../maps/scripts/app-30808538be.js.map
